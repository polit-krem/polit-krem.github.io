<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Довідник наукового ліцею «Політ»</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script> 
    <link rel="stylesheet" type="text/css" href="CSS/group_item.css">
    <link rel="stylesheet" type="text/css" href="CSS/Header.css">
    <link rel="stylesheet" type="text/css" href="CSS/Footer.css">
    <link rel="preconnect" href="https://fonts.gstatic.com"> 
	<link rel="shortcut icon" href="IMG/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="AvenirNext/stylesheet.css">
    <link href="https://fonts.googleapis.com/css2?family=Ledger&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" integrity="sha512-HK5fgLBL+xu6dm/Ii3z4xhlSUyZgTT9tuc/hSrtw6uzJOvgRr2a9jyxxT1ely+B+xFAmJKVSTbpM/CuL7qxO8w==" crossorigin="anonymous" />
	
</head>
<body>
    <header>
        <div class="up">
            <a href="index.html" class="alogo"><img src="IMG/logo.png" class="imgh"></a>
		<p class="par" id="par1">Довідник наукового ліцею «Політ»</p>
		<a href="index.html"><p class="par">Головна</p></a>
		<a href="Groups.html"><p class="par" class="pargr" >Групи</p></a>
		<a href="Teachers.html"><p class="par">Учителі</p></a>
		<a href="Contacts.html"><p class="par">Контакти</p></a>
	    </div>
    </header>
    <div class="Group_item">
        <p class="Group_Name" id="title">Група </p>
        <div class="One_Main">
            <div class="Rectangle_Main"> 
                <div class="Rectangle_One">
                        <div class="Path">
                            <img src="IMG/self-improvement-black-48-dp.svg" class="self_improvement_black_48dp">
                        </div>
                    <div class="teacher"id="teacher_name2">
                        <h1 class="teacher_p" >Класний керівник</h1>
                        
                    </div>
                    <div class="icon">
                            <img src="IMG/expand-more-white-48-dp.svg" class="expand_more_white_48dp2"  onclick="teacherGo()"> 
                        </div>
                    </div>
                    <div class="Rectangle_Two">
                        <div class="Path">
                            <img src="IMG/group-black-48-dp.svg" class="group_black_48dp">
                        </div>
                        <div class="student" id="students_num">
                            <p class="students">Кількість учнів</p>
                        </div>
                    </div>
                    <div class="Rectangle_Three">
                        <div class="Path">
                            <img src="IMG/school-black-48-dp.svg" class="school_black_48dp">
                        </div>
                        <div class="profile" id="profile_name">
                            <p class="profile_course">Профіль (напрямок навчання)</p>
                            
                        </div>
                    </div>
                    <div class="Rectangle_Four">
                        <div class="Path">
                            <img src="IMG/text-snippet-black-48-dp.svg" class="text_snippet_black_48dp">
                        </div>
                        <div class="subject"  id="subject_name">
                            <p class="subject_education">Предмети для поглибленого вивчення</p>
                             
                        </div>
                </div>
            </div>
            <div class="pic_group">
                <img src="IMG/pic-group-item.png" srcset="pic-group-item@2x.png 2x,pic-group-item@3x.png 3x" class="Pic_group_item">
            </div>
        </div>
        <div class="Two_Main">
            <p class="pupil">Учні</p>
            <div class="search">
                <div class="search_icon">
                    <img src="IMG/search-white-48-dp.svg" class="search_white_48dp">
                </div>
                <div class="search_input_div">
                    <input type="text" placeholder="Пошук…" class="search_input" id="filter">
                </div>
            </div>
        </div>
        <div class="Three_Main" id="main">
            <div class="fio">
                <p class="foto">Фото</p>
                <p class="pib">ПІБ</p>
                <button class="sortByName" id="sortByNameBtn"> <span class="button_sort">Сортувати за:</span> <span class="button_type">Алфавітом</span></button>
            </div>
            <div class="group" id="api_fetch">
                <div class="student_information1" id="no_rezult">
					<p class="log">Даних не знайдено</p>
				</div>
            </div>
        </div>
    </div>
    <center><footer>
		<a href="index.html"><img src="IMG/logo.png" class="imgfoot"></a>
		<p class="copy">©Веб-сайт «Довідник наукового ліцею «Політ», 2021. Усі права захищені.</p>
	</footer></center>

    <script>
    var url_string = window.location.href;
    var url = new URL(url_string);
    var v = url.searchParams.get("id");
    var new_url = "https://alexmarchukprod.com.ua/group?id=" + v;

    window.addEventListener("load", async function() {
            fetch(new_url)
                .then((result) => {
                    result.json().then((data) => {
                        console.log(data.title)
                        const title = document.createElement("span");
                        title.className = "Group_Name";
                        
                        title.innerHTML = data.title;
                        document.querySelector('#title').appendChild(title);
                    })
                })
            });
            function go1(){
            var teacher = document.getElementsByClassName(teacher_name);
            var teachers = teacher.getAttribute('id');
            console.log()
            var id = event.target.getAttribute('id');
            var upl = "Teacher_item.html?id=" + id;
            console.log(upl)
            window.location.href = upl;
        }    
    window.addEventListener("load", async function() {
            fetch(new_url)
                .then((result) => {
                    result.json().then((data) => {
                        console.log(data.formMaster.surname)
                        const teacher_name = document.createElement("p");
                        teacher_name.id = data.formMaster.id;
                        teacher_name.className = "teacher_name";
                        teacher_name.innerHTML = data.formMaster.surname + " " + data.formMaster.name + " " + data.formMaster.patronymic ;
                        document.querySelector('#teacher_name2').appendChild(teacher_name);
                    })
                })
            });  
    function teacherGo(){
        var id = document.querySelector(".teacher_name").getAttribute("id");
        console.log(id)
        var upl_teacher = "teacher_item.html?id=" + id;
        console.log(upl_teacher)
            window.location.href = upl_teacher;
    }
            window.addEventListener("load", async function() {
            fetch(new_url)
                .then((result) => {
                    result.json().then((data) => {
                        console.log(data.formMaster.surname)
                        const students_num = document.createElement("p");
                        students_num.className = "students_num";
                        students_num.innerHTML = data.students.length ;
                        document.querySelector('#students_num').appendChild(students_num);
                    })
                })
            }); 
            window.addEventListener("load", async function() {
            fetch(new_url)
                .then((result) => {
                    result.json().then((data) => {
                        console.log(data.specialization)
                        const profile_name = document.createElement("p");
                        profile_name.className = "profile_name";
                        profile_name.innerHTML = data.specialization ;
                        document.querySelector('#profile_name').appendChild(profile_name);
                    })
                })
            });    
            window.addEventListener("load", async function() {
            fetch(new_url)
                .then((result) => {
                    result.json().then((data) => {
                        
                            console.log(data.advancedSubjects)
                            const subject_name = document.createElement("ul");
                            subject_name.className = "subject_name";
                            let str = ' ';
                            for (let i = 0; i< data.advancedSubjects.length; i++  ) {
                                if (data.advancedSubjects[i]!==undefined) 
                                str += data.advancedSubjects[i]+'<br>';
                                subject_name.innerHTML =   `<li class="li">${str}</li> <br class="br">`;
                            }
                            document.querySelector('#subject_name').appendChild(subject_name);
                    })
                })
            }); 
            window.addEventListener("load", async function() {
            fetch("https://alexmarchukprod.com.ua/students")
            .then((result) => {
                result.json().then((data) => {
                    data.forEach((item) => {
                        const output = document.createElement("div");
                        output.className = "student_information";
                        output.innerHTML = `<img class="Avatar" src="IMG/avatar.png">
                                            <p class="pib_student" >${item.surname} ${item.name} ${item.patronymic}</p>
                                            <img src="IMG/expand-more-white-48-dp.svg" class="expand_more_white_48dp1" onclick="go2();" id="${item.id}">`;
                        document.querySelector('#api_fetch').appendChild(output);
                    })
                })
            })
    });

    function go2(){
            var id = event.target.getAttribute('id');
            var upl = "pupil_item.html?id=" + id;
            console.log(upl)
            window.location.href = upl;
        } 

        $("#filter").keyup(function() {
		var filter = $(this).val(),
		count = 0;
		$('#api_fetch .student_information').each(function() {
		if ($(this).text().search(new RegExp(filter, "i")) < 0) {
			$(this).hide();  
				var numrelated=$('.group > .student_information:visible').length;
				console.log(numrelated);
			if(numrelated > 0){
				main.style.marginBottom = "80px";
                document.getElementById("no_rezult").style.display = "none";
			}
			if(numrelated === 4){
				main.style.marginBottom = "-21px";
			}			
			if(numrelated === 0){
				document.getElementById("no_rezult").style.display = "flex";
				main.style.marginBottom = "80px";
			}
		}
		
		else {
			$(this).show(); 
			count++;
		}
		});
		});
		
        var sortByNameBtn = document.getElementById('sortByNameBtn');

        function sortingByName() {
        var items = document.querySelectorAll('.student_information');
        Array.from(items).sort(function(a, b) {
            a = a.querySelector('.pib_student').innerText.toLowerCase()
            b = b.querySelector('.pib_student').innerText.toLowerCase()
            return (a > b) - (a < b)
        }).forEach(function(n, i) {
            n.style.order = i
        })
        }

        sortByNameBtn.addEventListener('click', sortingByName);
    </script>
</body>
</html>